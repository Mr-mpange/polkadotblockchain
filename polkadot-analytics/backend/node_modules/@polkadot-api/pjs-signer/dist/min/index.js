"use strict";var P=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var H=Object.prototype.hasOwnProperty;var f=(e,n)=>{for(var t in n)P(e,t,{get:n[t],enumerable:!0})},C=(e,n,t,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let c of w(n))!H.call(e,c)&&c!==t&&P(e,c,{get:()=>n[c],enumerable:!(s=v(n,c))||s.enumerable});return e};var U=e=>C(P({},"__esModule",{value:!0}),e);var q={};f(q,{connectInjectedExtension:()=>_,getInjectedExtensions:()=>G});module.exports=U(q);var E=require("@polkadot-api/substrate-bindings");var i=require("@polkadot-api/substrate-bindings"),g=require("@polkadot-api/utils"),j=require("@polkadot-api/metadata-builders");var S={};f(S,{ChargeAssetTxPayment:()=>V,ChargeTransactionPayment:()=>J,CheckGenesis:()=>M,CheckMetadataHash:()=>F,CheckMortality:()=>B,CheckNonce:()=>N,CheckSpecVersion:()=>W,CheckTxVersion:()=>O});var r=require("@polkadot-api/substrate-bindings"),x=require("@polkadot-api/utils"),p=(e,n)=>{let t=e.toString(16);t=(t.length%2?"0":"")+t;let s=Math.max(0,(n||0)-t.length/2);return"0x"+"00".repeat(s)+t},M=({additionalSigned:e})=>({genesisHash:(0,x.toHex)(e)}),N=({value:e})=>({nonce:p(r.compact.dec(e),4)}),O=({additionalSigned:e})=>({transactionVersion:p(r.u32.dec(e),4)}),T=(0,r.Struct)({tip:r.compact,asset:(0,r.Option)((0,r.Bytes)(1/0))}).dec,V=({value:e})=>{let{tip:n,asset:t}=T(e);return{...t?{assetId:(0,x.toHex)(t)}:{},tip:p(n,16)}},J=({value:e})=>({tip:p(r.compactBn.dec(e),16)}),B=({value:e,additionalSigned:n},t)=>({era:(0,x.toHex)(e),blockHash:(0,x.toHex)(n),blockNumber:p(t,4)}),W=({additionalSigned:e})=>({specVersion:p(r.u32.dec(e),4)}),F=()=>({});var K=e=>{let n=(0,j.getDynamicBuilder)(e),t=e.pallets.find(s=>s.name==="System").constants.find(s=>s.name==="SS58Prefix");return n.buildDefinition(t.type).dec(t.value)},R=(0,i.enhanceEncoder)(i.u8.enc,e=>+!!e.signed<<7|e.version);function A(e,n){return{publicKey:e,sign:async(s,c,l,u,k=i.Blake2256)=>{let a;try{let d=i.metadata.dec(l);if(d.metadata.tag!=="v15")throw null;a=d.metadata.value}catch{throw new Error("Unsupported metadata version")}let o={};o.signedExtensions=[];let{version:y}=a.extrinsic,b=[];a.extrinsic.signedExtensions.map(({identifier:d})=>{let m=c[d];if(!m)throw new Error(`Missing ${d} signed-extension`);if(b.push(m.value),o.signedExtensions.push(d),!S[d]){if(m.value.length===0&&m.additionalSigned.length===0)return;throw new Error(`PJS does not support this signed-extension: ${d}`)}Object.assign(o,S[d](m,u))}),o.address=(0,i.AccountId)(K(a)).dec(e),o.method=(0,g.toHex)(s),o.version=y;let I=await n(o),h=(0,g.mergeUint8)(R({signed:!0,version:y}),new Uint8Array([0,...e]),(0,g.fromHex)(I.signature),...b,s);return(0,g.mergeUint8)(i.compact.enc(h.length),h)}}}var $=new Set(["ed25519","sr25519","ecdsa"]),D=(0,E.AccountId)().enc,_=async e=>{let n=window.injectedWeb3?.[e];if(!n)throw new Error(`Unavailable extension: "${e}"`);let t=await n.enable(),s=t.signer.signPayload.bind(t.signer),c=a=>a.filter(({type:o})=>$.has(o)).map(o=>{let y=A(D(o.address),s);return{...o,polkadotSigner:y}}),l=c(await t.accounts.get()),u=new Set,k=t.accounts.subscribe(a=>{l=c(a),u.forEach(o=>{o(l)})});return{name:e,getAccounts:()=>l,subscribe:a=>(u.add(a),()=>{u.delete(a)}),disconnect:()=>{k()}}},G=()=>{let{injectedWeb3:e}=window;return e?Object.keys(e):null};
//# sourceMappingURL=index.js.map
{"version":3,"sources":["../../../src/from-worker.ts"],"sourcesContent":["import type { Client } from \"smoldot\"\nimport {\n  type SmoldotBytecode,\n  type ClientOptionsWithBytecode,\n  startWithBytecode,\n} from \"smoldot/no-auto-bytecode\"\n\nexport type SmoldotOptions = Omit<\n  ClientOptionsWithBytecode,\n  \"bytecode\" | \"portToWorker\"\n>\n\nexport const startFromWorker = (\n  worker: Worker,\n  options: SmoldotOptions = {},\n): Client => {\n  const bytecode = new Promise<SmoldotBytecode>((resolve) => {\n    worker.onmessage = (event) => resolve(event.data)\n  })\n\n  const { port1, port2 } = new MessageChannel()\n  worker.postMessage(port1, [port1])\n\n  return startWithBytecode({\n    bytecode,\n    portToWorker: port2,\n    ...options,\n  })\n}\n"],"mappings":"yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,qBAAAE,IAAA,eAAAC,EAAAH,GACA,IAAAI,EAIO,oCAOMF,EAAkB,CAC7BG,EACAC,EAA0B,CAAC,IAChB,CACX,IAAMC,EAAW,IAAI,QAA0BC,GAAY,CACzDH,EAAO,UAAaI,GAAUD,EAAQC,EAAM,IAAI,CAClD,CAAC,EAEK,CAAE,MAAAC,EAAO,MAAAC,CAAM,EAAI,IAAI,eAC7B,OAAAN,EAAO,YAAYK,EAAO,CAACA,CAAK,CAAC,KAE1B,qBAAkB,CACvB,SAAAH,EACA,aAAcI,EACd,GAAGL,CACL,CAAC,CACH","names":["from_worker_exports","__export","startFromWorker","__toCommonJS","import_no_auto_bytecode","worker","options","bytecode","resolve","event","port1","port2"]}
{"version":3,"sources":["../../src/from-worker.ts"],"sourcesContent":["import type { Client } from \"smoldot\"\nimport {\n  type SmoldotBytecode,\n  type ClientOptionsWithBytecode,\n  startWithBytecode,\n} from \"smoldot/no-auto-bytecode\"\n\nexport type SmoldotOptions = Omit<\n  ClientOptionsWithBytecode,\n  \"bytecode\" | \"portToWorker\"\n>\n\nexport const startFromWorker = (\n  worker: Worker,\n  options: SmoldotOptions = {},\n): Client => {\n  const bytecode = new Promise<SmoldotBytecode>((resolve) => {\n    worker.onmessage = (event) => resolve(event.data)\n  })\n\n  const { port1, port2 } = new MessageChannel()\n  worker.postMessage(port1, [port1])\n\n  return startWithBytecode({\n    bytecode,\n    portToWorker: port2,\n    ...options,\n  })\n}\n"],"mappings":";AACA;AAAA,EAGE;AAAA,OACK;AAOA,IAAM,kBAAkB,CAC7B,QACA,UAA0B,CAAC,MAChB;AACX,QAAM,WAAW,IAAI,QAAyB,CAAC,YAAY;AACzD,WAAO,YAAY,CAAC,UAAU,QAAQ,MAAM,IAAI;AAAA,EAClD,CAAC;AAED,QAAM,EAAE,OAAO,MAAM,IAAI,IAAI,eAAe;AAC5C,SAAO,YAAY,OAAO,CAAC,KAAK,CAAC;AAEjC,SAAO,kBAAkB;AAAA,IACvB;AAAA,IACA,cAAc;AAAA,IACd,GAAG;AAAA,EACL,CAAC;AACH;","names":[]}